import { Component, ContentChildren, EventEmitter, Input, Output } from '@angular/core';
import { hasValue } from '../../../utils/utils';
import { DataType } from '../../../models/data-type';
import { TableColumnDirective } from '../table-column.directive';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "primeng/button";
import * as i3 from "primeng/api";
import * as i4 from "../../filter/filter/filter.component";
import * as i5 from "../../action/action/action.component";
import * as i6 from "primeng/table";
export class TableComponent {
    constructor() {
        this.params = {};
        this.pageSize = 10;
        this.changed = new EventEmitter();
        this.onColReordered = new EventEmitter();
        this.DataType = DataType;
    }
    set data(value) { this.items = value; }
    ngOnInit() {
        this.params.filters = this.filters?.map(x => x.request)?.filter(x => hasValue(x));
    }
    clearSelection() {
        this.selected = [];
    }
    sort(event) {
        const direction = (event.order == 1) ? 'asc' : 'desc';
        this.params.orderBy = event.field?.split(' ')?.map(x => x + ' ' + direction);
        this.changed.emit(this.params);
    }
    pageChange(event) {
        this.params.pageNumber = event.first / event.rows + 1;
        this.params.pageSize = event.rows;
        this.changed.emit(this.params);
    }
    filter(requests) {
        this.params.pageNumber = 1;
        this.params.filters = requests.filter(x => hasValue(x));
        this.changed.emit(this.params);
    }
    getTemplate(name) {
        return this.templates?.find(x => x.id === name)?.template ?? null;
    }
    onColReorder(event) {
        this.onColReordered.emit(event);
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.2.0", ngImport: i0, type: TableComponent, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "17.2.0", type: TableComponent, selector: "g-table", inputs: { columns: "columns", params: "params", actions: "actions", tableActions: "tableActions", bulkActions: "bulkActions", filters: "filters", totalItems: "totalItems", pageSize: "pageSize", data: "data" }, outputs: { changed: "changed", onColReordered: "onColReordered" }, queries: [{ propertyName: "templates", predicate: TableColumnDirective }], ngImport: i0, template: "<!-- Bulk actions -->\n<div *ngIf=\"bulkActions?.length && selected?.length\" class=\"d-flex justify-content-between p-3 mb-3 rounded bg-light\">\n  <p-button [label]=\"'Annulla selezione'\" (click)=\"clearSelection()\" styleClass=\"p-button-outlined p-button-secondary\" />\n  <app-action [data]=\"selected\" [actions]=\"bulkActions\" class=\"d-flex gap-2\">\n    <ng-template #template let-action>\n      <p-button [label]=\"action.label\" />\n    </ng-template>\n  </app-action>\n</div>\n\n<!-- Table filters and actions -->\n<div *ngIf=\"filters?.length || tableActions?.length\" class=\"d-flex gap-3 justify-content-between align-items-center pb-3 overflow-auto\">\n  <app-filter [filters]=\"filters\" (onFilter)=\"filter($event)\" class=\"flex-grow-1\" />\n  <app-action *ngIf=\"tableActions?.length\" [actions]=\"tableActions\" class=\"d-flex gap-2\">\n    <ng-template #template let-action>\n      <p-button [label]=\"action.label\" />\n    </ng-template>\n  </app-action>\n</div>\n\n<!-- Table -->\n<p-table [resizableColumns]=\"true\" [value]=\"items ?? []\" responsiveLayout=\"scroll\" (onSort)=\"sort($event)\"\n  [customSort]=\"true\" [lazy]=\"true\" [(selection)]=\"selected\" [columns]=\"columns\"\n  [reorderableColumns]=\"true\" (onColReorder)=\"onColReorder($event)\"\n  [paginator]=\"true\" [alwaysShowPaginator]=\"false\" [totalRecords]=\"totalItems ?? items?.length ?? 0\" [rows]=\"pageSize\"\n  [showCurrentPageReport]=\"true\" currentPageReportTemplate=\"{first} - {last} di {totalRecords}\"\n  [rowsPerPageOptions]=\"[5, 10, 25, 100]\" (onPage)=\"pageChange($event)\">\n  \n  <!-- Table header -->\n  <ng-template pTemplate=\"header\">\n    <tr>\n      <th style=\"width:0\" *ngIf=\"bulkActions?.length\">\n        <p-tableHeaderCheckbox />\n      </th>\n      <th *ngFor=\"let column of columns\" [pSortableColumn]=\"column.sort ?? ''\" pReorderableColumn>\n        {{column.name}} <p-sortIcon *ngIf=\"column.sort\" [field]=\"column.sort\" />\n      </th>\n      <th *ngIf=\"actions\" class=\"text-end\" style=\"width:0\"></th>\n    </tr>\n  </ng-template>\n\n  <!-- Table body -->\n  <ng-template pTemplate=\"body\" let-item let-rowIndex=\"rowIndex\">\n    <tr [pSelectableRow]=\"item\" [pSelectableRowIndex]=\"rowIndex\">\n      <td *ngIf=\"bulkActions?.length\">\n        <p-tableCheckbox [value]=\"item\" />\n      </td>\n      <td *ngFor=\"let column of columns;\">\n        <ng-container [ngTemplateOutlet]=\"column.template ? getTemplate(column.template) : template\"\n          [ngTemplateOutletContext]=\"{ $implicit: item, column }\" />\n      </td>\n      <td class=\"text-end\" *ngIf=\"actions\">\n        <app-action [data]=\"item\" [actions]=\"actions\" />\n      </td>\n    </tr>\n  </ng-template>\n\n  <ng-template pTemplate=\"emptymessage\">\n    <tr>\n      <td class=\"mat-cell text-center\" [attr.colspan]=\"100\">\n        {{ 'Nessun elemento da visualizzare' }} <!-- // TODO: Translate -->\n      </td>\n    </tr>\n  </ng-template>\n  <ng-template pTemplate=\"paginatorleft\"></ng-template>\n</p-table>\n\n<!-- Table data template -->\n<ng-template #template let-item let-column=\"column\">\n  @switch (column.type) {\n    @case (DataType.Date) {\n        {{ column.value(item) | date: 'dd/MM/yyyy' }}\n    }\n    @case (DataType.DateTime) {\n        {{ column.value(item) | date: 'dd/MM/yyyy, hh:mm' }}\n    }\n    @case (DataType.Amount) {\n        {{ column.value(item) | currency: 'EUR': 'symbol' : undefined: 'it-IT' }}\n    }\n    @case (DataType.Bool) {\n        {{ column.value(item) ? 'Si': 'No' }}\n    <!-- // TODO: Translate -->\n    }\n    @case (DataType.Color) {\n        <i class=\"bi bi-circle-fill\" [style.color]=\"column.value(item)\"></i>\n    }\n    @default {\n        {{ column.value(item) }}\n    }\n  }\n</ng-template>", styles: [":host::ng-deep .p-datatable .p-datatable-tbody>tr>td{padding:.5rem 1rem;height:3.5rem}\n"], dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i2.Button, selector: "p-button", inputs: ["type", "iconPos", "icon", "badge", "label", "disabled", "loading", "loadingIcon", "raised", "rounded", "text", "plain", "severity", "outlined", "link", "size", "style", "styleClass", "badgeClass", "ariaLabel"], outputs: ["onClick", "onFocus", "onBlur"] }, { kind: "directive", type: i3.PrimeTemplate, selector: "[pTemplate]", inputs: ["type", "pTemplate"] }, { kind: "component", type: i4.FilterComponent, selector: "app-filter", inputs: ["filters"], outputs: ["onFilter"] }, { kind: "component", type: i5.ActionComponent, selector: "app-action", inputs: ["actions", "data"] }, { kind: "component", type: i6.Table, selector: "p-table", inputs: ["frozenColumns", "frozenValue", "style", "styleClass", "tableStyle", "tableStyleClass", "paginator", "pageLinks", "rowsPerPageOptions", "alwaysShowPaginator", "paginatorPosition", "paginatorStyleClass", "paginatorDropdownAppendTo", "paginatorDropdownScrollHeight", "currentPageReportTemplate", "showCurrentPageReport", "showJumpToPageDropdown", "showJumpToPageInput", "showFirstLastIcon", "showPageLinks", "defaultSortOrder", "sortMode", "resetPageOnSort", "selectionMode", "selectionPageOnly", "contextMenuSelection", "contextMenuSelectionMode", "dataKey", "metaKeySelection", "rowSelectable", "rowTrackBy", "lazy", "lazyLoadOnInit", "compareSelectionBy", "csvSeparator", "exportFilename", "filters", "globalFilterFields", "filterDelay", "filterLocale", "expandedRowKeys", "editingRowKeys", "rowExpandMode", "scrollable", "scrollDirection", "rowGroupMode", "scrollHeight", "virtualScroll", "virtualScrollItemSize", "virtualScrollOptions", "virtualScrollDelay", "frozenWidth", "responsive", "contextMenu", "resizableColumns", "columnResizeMode", "reorderableColumns", "loading", "loadingIcon", "showLoader", "rowHover", "customSort", "showInitialSortBadge", "autoLayout", "exportFunction", "exportHeader", "stateKey", "stateStorage", "editMode", "groupRowsBy", "groupRowsByOrder", "responsiveLayout", "breakpoint", "paginatorLocale", "value", "columns", "first", "rows", "totalRecords", "sortField", "sortOrder", "multiSortMeta", "selection", "selectAll", "virtualRowHeight"], outputs: ["contextMenuSelectionChange", "selectAllChange", "selectionChange", "onRowSelect", "onRowUnselect", "onPage", "onSort", "onFilter", "onLazyLoad", "onRowExpand", "onRowCollapse", "onContextMenuSelect", "onColResize", "onColReorder", "onRowReorder", "onEditInit", "onEditComplete", "onEditCancel", "onHeaderCheckboxToggle", "sortFunction", "firstChange", "rowsChange", "onStateSave", "onStateRestore"] }, { kind: "directive", type: i6.SortableColumn, selector: "[pSortableColumn]", inputs: ["pSortableColumn", "pSortableColumnDisabled"] }, { kind: "directive", type: i6.SelectableRow, selector: "[pSelectableRow]", inputs: ["pSelectableRow", "pSelectableRowIndex", "pSelectableRowDisabled"] }, { kind: "directive", type: i6.ReorderableColumn, selector: "[pReorderableColumn]", inputs: ["pReorderableColumnDisabled"] }, { kind: "component", type: i6.SortIcon, selector: "p-sortIcon", inputs: ["field"] }, { kind: "component", type: i6.TableCheckbox, selector: "p-tableCheckbox", inputs: ["disabled", "value", "index", "inputId", "name", "required", "ariaLabel"] }, { kind: "component", type: i6.TableHeaderCheckbox, selector: "p-tableHeaderCheckbox", inputs: ["disabled", "inputId", "name", "ariaLabel"] }, { kind: "pipe", type: i1.CurrencyPipe, name: "currency" }, { kind: "pipe", type: i1.DatePipe, name: "date" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.2.0", ngImport: i0, type: TableComponent, decorators: [{
            type: Component,
            args: [{ selector: 'g-table', template: "<!-- Bulk actions -->\n<div *ngIf=\"bulkActions?.length && selected?.length\" class=\"d-flex justify-content-between p-3 mb-3 rounded bg-light\">\n  <p-button [label]=\"'Annulla selezione'\" (click)=\"clearSelection()\" styleClass=\"p-button-outlined p-button-secondary\" />\n  <app-action [data]=\"selected\" [actions]=\"bulkActions\" class=\"d-flex gap-2\">\n    <ng-template #template let-action>\n      <p-button [label]=\"action.label\" />\n    </ng-template>\n  </app-action>\n</div>\n\n<!-- Table filters and actions -->\n<div *ngIf=\"filters?.length || tableActions?.length\" class=\"d-flex gap-3 justify-content-between align-items-center pb-3 overflow-auto\">\n  <app-filter [filters]=\"filters\" (onFilter)=\"filter($event)\" class=\"flex-grow-1\" />\n  <app-action *ngIf=\"tableActions?.length\" [actions]=\"tableActions\" class=\"d-flex gap-2\">\n    <ng-template #template let-action>\n      <p-button [label]=\"action.label\" />\n    </ng-template>\n  </app-action>\n</div>\n\n<!-- Table -->\n<p-table [resizableColumns]=\"true\" [value]=\"items ?? []\" responsiveLayout=\"scroll\" (onSort)=\"sort($event)\"\n  [customSort]=\"true\" [lazy]=\"true\" [(selection)]=\"selected\" [columns]=\"columns\"\n  [reorderableColumns]=\"true\" (onColReorder)=\"onColReorder($event)\"\n  [paginator]=\"true\" [alwaysShowPaginator]=\"false\" [totalRecords]=\"totalItems ?? items?.length ?? 0\" [rows]=\"pageSize\"\n  [showCurrentPageReport]=\"true\" currentPageReportTemplate=\"{first} - {last} di {totalRecords}\"\n  [rowsPerPageOptions]=\"[5, 10, 25, 100]\" (onPage)=\"pageChange($event)\">\n  \n  <!-- Table header -->\n  <ng-template pTemplate=\"header\">\n    <tr>\n      <th style=\"width:0\" *ngIf=\"bulkActions?.length\">\n        <p-tableHeaderCheckbox />\n      </th>\n      <th *ngFor=\"let column of columns\" [pSortableColumn]=\"column.sort ?? ''\" pReorderableColumn>\n        {{column.name}} <p-sortIcon *ngIf=\"column.sort\" [field]=\"column.sort\" />\n      </th>\n      <th *ngIf=\"actions\" class=\"text-end\" style=\"width:0\"></th>\n    </tr>\n  </ng-template>\n\n  <!-- Table body -->\n  <ng-template pTemplate=\"body\" let-item let-rowIndex=\"rowIndex\">\n    <tr [pSelectableRow]=\"item\" [pSelectableRowIndex]=\"rowIndex\">\n      <td *ngIf=\"bulkActions?.length\">\n        <p-tableCheckbox [value]=\"item\" />\n      </td>\n      <td *ngFor=\"let column of columns;\">\n        <ng-container [ngTemplateOutlet]=\"column.template ? getTemplate(column.template) : template\"\n          [ngTemplateOutletContext]=\"{ $implicit: item, column }\" />\n      </td>\n      <td class=\"text-end\" *ngIf=\"actions\">\n        <app-action [data]=\"item\" [actions]=\"actions\" />\n      </td>\n    </tr>\n  </ng-template>\n\n  <ng-template pTemplate=\"emptymessage\">\n    <tr>\n      <td class=\"mat-cell text-center\" [attr.colspan]=\"100\">\n        {{ 'Nessun elemento da visualizzare' }} <!-- // TODO: Translate -->\n      </td>\n    </tr>\n  </ng-template>\n  <ng-template pTemplate=\"paginatorleft\"></ng-template>\n</p-table>\n\n<!-- Table data template -->\n<ng-template #template let-item let-column=\"column\">\n  @switch (column.type) {\n    @case (DataType.Date) {\n        {{ column.value(item) | date: 'dd/MM/yyyy' }}\n    }\n    @case (DataType.DateTime) {\n        {{ column.value(item) | date: 'dd/MM/yyyy, hh:mm' }}\n    }\n    @case (DataType.Amount) {\n        {{ column.value(item) | currency: 'EUR': 'symbol' : undefined: 'it-IT' }}\n    }\n    @case (DataType.Bool) {\n        {{ column.value(item) ? 'Si': 'No' }}\n    <!-- // TODO: Translate -->\n    }\n    @case (DataType.Color) {\n        <i class=\"bi bi-circle-fill\" [style.color]=\"column.value(item)\"></i>\n    }\n    @default {\n        {{ column.value(item) }}\n    }\n  }\n</ng-template>", styles: [":host::ng-deep .p-datatable .p-datatable-tbody>tr>td{padding:.5rem 1rem;height:3.5rem}\n"] }]
        }], propDecorators: { columns: [{
                type: Input
            }], params: [{
                type: Input
            }], actions: [{
                type: Input
            }], tableActions: [{
                type: Input
            }], bulkActions: [{
                type: Input
            }], filters: [{
                type: Input
            }], totalItems: [{
                type: Input
            }], pageSize: [{
                type: Input
            }], data: [{
                type: Input
            }], changed: [{
                type: Output
            }], onColReordered: [{
                type: Output
            }], templates: [{
                type: ContentChildren,
                args: [TableColumnDirective]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFibGUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LWNvbXBvbmVudHMvc3JjL2xpYi90YWJsZS90YWJsZS90YWJsZS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9uZ3gtY29tcG9uZW50cy9zcmMvbGliL3RhYmxlL3RhYmxlL3RhYmxlLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsZUFBZSxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQVUsTUFBTSxFQUEwQixNQUFNLGVBQWUsQ0FBQztBQUd4SCxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFJaEQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDOzs7Ozs7OztBQU9qRSxNQUFNLE9BQU8sY0FBYztJQUwzQjtRQVFXLFdBQU0sR0FBUSxFQUFHLENBQUM7UUFNbEIsYUFBUSxHQUFZLEVBQUUsQ0FBQztRQUd0QixZQUFPLEdBQUcsSUFBSSxZQUFZLEVBQUUsQ0FBQztRQUM3QixtQkFBYyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFJbkQsYUFBUSxHQUFHLFFBQVEsQ0FBQztLQW1DckI7SUExQ0MsSUFBYSxJQUFJLENBQUMsS0FBd0IsSUFBSSxJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQSxDQUFDLENBQUM7SUFTbEUsUUFBUTtRQUNOLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3BGLENBQUM7SUFFRCxjQUFjO1FBQ1osSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7SUFDckIsQ0FBQztJQUVELElBQUksQ0FBQyxLQUFnQjtRQUNuQixNQUFNLFNBQVMsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO1FBQ3RELElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUcsU0FBUyxDQUFDLENBQUM7UUFDN0UsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxVQUFVLENBQUMsS0FBVTtRQUNuQixJQUFJLENBQUMsTUFBTSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUM7UUFDbEMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2pDLENBQUM7SUFFRCxNQUFNLENBQUMsUUFBeUI7UUFDOUIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDO1FBQzNCLElBQUksQ0FBQyxNQUFNLENBQUMsT0FBTyxHQUFHLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN4RCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVELFdBQVcsQ0FBQyxJQUFZO1FBQ3RCLE9BQU8sSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxFQUFFLFFBQVEsSUFBSSxJQUFJLENBQUM7SUFDcEUsQ0FBQztJQUVELFlBQVksQ0FBQyxLQUFVO1FBQ3JCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xDLENBQUM7OEdBbkRVLGNBQWM7a0dBQWQsY0FBYyw4VkFjUixvQkFBb0IsNkJDN0J2QyxpdEhBMEZjOzsyRkQzRUQsY0FBYztrQkFMMUIsU0FBUzsrQkFDRSxTQUFTOzhCQU1WLE9BQU87c0JBQWYsS0FBSztnQkFDRyxNQUFNO3NCQUFkLEtBQUs7Z0JBQ0csT0FBTztzQkFBZixLQUFLO2dCQUNHLFlBQVk7c0JBQXBCLEtBQUs7Z0JBQ0csV0FBVztzQkFBbkIsS0FBSztnQkFDRyxPQUFPO3NCQUFmLEtBQUs7Z0JBQ0csVUFBVTtzQkFBbEIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNPLElBQUk7c0JBQWhCLEtBQUs7Z0JBRUksT0FBTztzQkFBaEIsTUFBTTtnQkFDRyxjQUFjO3NCQUF2QixNQUFNO2dCQUNnQyxTQUFTO3NCQUEvQyxlQUFlO3VCQUFDLG9CQUFvQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgQ29udGVudENoaWxkcmVuLCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkluaXQsIE91dHB1dCwgUXVlcnlMaXN0LCBUZW1wbGF0ZVJlZiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU29ydEV2ZW50IH0gZnJvbSAncHJpbWVuZy9hcGknO1xuaW1wb3J0IHsgRmlsdGVyUmVxdWVzdCB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9maWx0ZXItcmVxdWVzdCc7XG5pbXBvcnQgeyBoYXNWYWx1ZSB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3V0aWxzJztcbmltcG9ydCB7IEZpbHRlciB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9maWx0ZXInO1xuaW1wb3J0IHsgVGFibGVDb2x1bW4gfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvdGFibGUtY29sdW1uJztcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gJy4uLy4uLy4uL21vZGVscy9hY3Rpb24nO1xuaW1wb3J0IHsgRGF0YVR5cGUgfSBmcm9tICcuLi8uLi8uLi9tb2RlbHMvZGF0YS10eXBlJztcbmltcG9ydCB7IFRhYmxlQ29sdW1uRGlyZWN0aXZlIH0gZnJvbSAnLi4vdGFibGUtY29sdW1uLmRpcmVjdGl2ZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2ctdGFibGUnLFxuICB0ZW1wbGF0ZVVybDogJy4vdGFibGUuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi90YWJsZS5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFRhYmxlQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICBASW5wdXQoKSBjb2x1bW5zITogVGFibGVDb2x1bW5bXTtcbiAgQElucHV0KCkgcGFyYW1zOiBhbnkgPSB7IH07XG4gIEBJbnB1dCgpIGFjdGlvbnM/OiBBY3Rpb25bXTtcbiAgQElucHV0KCkgdGFibGVBY3Rpb25zPzogQWN0aW9uW107XG4gIEBJbnB1dCgpIGJ1bGtBY3Rpb25zPzogQWN0aW9uW107XG4gIEBJbnB1dCgpIGZpbHRlcnM/OiBGaWx0ZXJbXTtcbiAgQElucHV0KCkgdG90YWxJdGVtcz86IG51bWJlcjtcbiAgQElucHV0KCkgcGFnZVNpemU/OiBudW1iZXIgPSAxMDtcbiAgQElucHV0KCkgc2V0IGRhdGEodmFsdWU6IGFueVtdIHwgdW5kZWZpbmVkKSB7IHRoaXMuaXRlbXMgPSB2YWx1ZSB9XG5cbiAgQE91dHB1dCgpIGNoYW5nZWQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBvbkNvbFJlb3JkZXJlZCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICBAQ29udGVudENoaWxkcmVuKFRhYmxlQ29sdW1uRGlyZWN0aXZlKSB0ZW1wbGF0ZXM/OiBRdWVyeUxpc3Q8VGFibGVDb2x1bW5EaXJlY3RpdmU+O1xuICBpdGVtcz86IGFueVtdO1xuICBzZWxlY3RlZD86IGFueVtdO1xuICBEYXRhVHlwZSA9IERhdGFUeXBlO1xuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMucGFyYW1zLmZpbHRlcnMgPSB0aGlzLmZpbHRlcnM/Lm1hcCh4ID0+IHgucmVxdWVzdCk/LmZpbHRlcih4ID0+IGhhc1ZhbHVlKHgpKTtcbiAgfVxuXG4gIGNsZWFyU2VsZWN0aW9uKCkge1xuICAgIHRoaXMuc2VsZWN0ZWQgPSBbXTtcbiAgfVxuXG4gIHNvcnQoZXZlbnQ6IFNvcnRFdmVudCkge1xuICAgIGNvbnN0IGRpcmVjdGlvbiA9IChldmVudC5vcmRlciA9PSAxKSA/ICdhc2MnIDogJ2Rlc2MnO1xuICAgIHRoaXMucGFyYW1zLm9yZGVyQnkgPSBldmVudC5maWVsZD8uc3BsaXQoJyAnKT8ubWFwKHggPT4geCArICcgJyArIGRpcmVjdGlvbik7XG4gICAgdGhpcy5jaGFuZ2VkLmVtaXQodGhpcy5wYXJhbXMpO1xuICB9XG5cbiAgcGFnZUNoYW5nZShldmVudDogYW55KSB7XG4gICAgdGhpcy5wYXJhbXMucGFnZU51bWJlciA9IGV2ZW50LmZpcnN0IC8gZXZlbnQucm93cyArIDE7XG4gICAgdGhpcy5wYXJhbXMucGFnZVNpemUgPSBldmVudC5yb3dzO1xuICAgIHRoaXMuY2hhbmdlZC5lbWl0KHRoaXMucGFyYW1zKTtcbiAgfVxuXG4gIGZpbHRlcihyZXF1ZXN0czogRmlsdGVyUmVxdWVzdFtdKSB7XG4gICAgdGhpcy5wYXJhbXMucGFnZU51bWJlciA9IDE7XG4gICAgdGhpcy5wYXJhbXMuZmlsdGVycyA9IHJlcXVlc3RzLmZpbHRlcih4ID0+IGhhc1ZhbHVlKHgpKTtcbiAgICB0aGlzLmNoYW5nZWQuZW1pdCh0aGlzLnBhcmFtcyk7XG4gIH1cblxuICBnZXRUZW1wbGF0ZShuYW1lOiBzdHJpbmcpOiBUZW1wbGF0ZVJlZjxhbnk+IHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMudGVtcGxhdGVzPy5maW5kKHggPT4geC5pZCA9PT0gbmFtZSk/LnRlbXBsYXRlID8/IG51bGw7XG4gIH1cblxuICBvbkNvbFJlb3JkZXIoZXZlbnQ6IGFueSkge1xuICAgIHRoaXMub25Db2xSZW9yZGVyZWQuZW1pdChldmVudCk7XG4gIH1cbn1cbiIsIjwhLS0gQnVsayBhY3Rpb25zIC0tPlxuPGRpdiAqbmdJZj1cImJ1bGtBY3Rpb25zPy5sZW5ndGggJiYgc2VsZWN0ZWQ/Lmxlbmd0aFwiIGNsYXNzPVwiZC1mbGV4IGp1c3RpZnktY29udGVudC1iZXR3ZWVuIHAtMyBtYi0zIHJvdW5kZWQgYmctbGlnaHRcIj5cbiAgPHAtYnV0dG9uIFtsYWJlbF09XCInQW5udWxsYSBzZWxlemlvbmUnXCIgKGNsaWNrKT1cImNsZWFyU2VsZWN0aW9uKClcIiBzdHlsZUNsYXNzPVwicC1idXR0b24tb3V0bGluZWQgcC1idXR0b24tc2Vjb25kYXJ5XCIgLz5cbiAgPGFwcC1hY3Rpb24gW2RhdGFdPVwic2VsZWN0ZWRcIiBbYWN0aW9uc109XCJidWxrQWN0aW9uc1wiIGNsYXNzPVwiZC1mbGV4IGdhcC0yXCI+XG4gICAgPG5nLXRlbXBsYXRlICN0ZW1wbGF0ZSBsZXQtYWN0aW9uPlxuICAgICAgPHAtYnV0dG9uIFtsYWJlbF09XCJhY3Rpb24ubGFiZWxcIiAvPlxuICAgIDwvbmctdGVtcGxhdGU+XG4gIDwvYXBwLWFjdGlvbj5cbjwvZGl2PlxuXG48IS0tIFRhYmxlIGZpbHRlcnMgYW5kIGFjdGlvbnMgLS0+XG48ZGl2ICpuZ0lmPVwiZmlsdGVycz8ubGVuZ3RoIHx8IHRhYmxlQWN0aW9ucz8ubGVuZ3RoXCIgY2xhc3M9XCJkLWZsZXggZ2FwLTMganVzdGlmeS1jb250ZW50LWJldHdlZW4gYWxpZ24taXRlbXMtY2VudGVyIHBiLTMgb3ZlcmZsb3ctYXV0b1wiPlxuICA8YXBwLWZpbHRlciBbZmlsdGVyc109XCJmaWx0ZXJzXCIgKG9uRmlsdGVyKT1cImZpbHRlcigkZXZlbnQpXCIgY2xhc3M9XCJmbGV4LWdyb3ctMVwiIC8+XG4gIDxhcHAtYWN0aW9uICpuZ0lmPVwidGFibGVBY3Rpb25zPy5sZW5ndGhcIiBbYWN0aW9uc109XCJ0YWJsZUFjdGlvbnNcIiBjbGFzcz1cImQtZmxleCBnYXAtMlwiPlxuICAgIDxuZy10ZW1wbGF0ZSAjdGVtcGxhdGUgbGV0LWFjdGlvbj5cbiAgICAgIDxwLWJ1dHRvbiBbbGFiZWxdPVwiYWN0aW9uLmxhYmVsXCIgLz5cbiAgICA8L25nLXRlbXBsYXRlPlxuICA8L2FwcC1hY3Rpb24+XG48L2Rpdj5cblxuPCEtLSBUYWJsZSAtLT5cbjxwLXRhYmxlIFtyZXNpemFibGVDb2x1bW5zXT1cInRydWVcIiBbdmFsdWVdPVwiaXRlbXMgPz8gW11cIiByZXNwb25zaXZlTGF5b3V0PVwic2Nyb2xsXCIgKG9uU29ydCk9XCJzb3J0KCRldmVudClcIlxuICBbY3VzdG9tU29ydF09XCJ0cnVlXCIgW2xhenldPVwidHJ1ZVwiIFsoc2VsZWN0aW9uKV09XCJzZWxlY3RlZFwiIFtjb2x1bW5zXT1cImNvbHVtbnNcIlxuICBbcmVvcmRlcmFibGVDb2x1bW5zXT1cInRydWVcIiAob25Db2xSZW9yZGVyKT1cIm9uQ29sUmVvcmRlcigkZXZlbnQpXCJcbiAgW3BhZ2luYXRvcl09XCJ0cnVlXCIgW2Fsd2F5c1Nob3dQYWdpbmF0b3JdPVwiZmFsc2VcIiBbdG90YWxSZWNvcmRzXT1cInRvdGFsSXRlbXMgPz8gaXRlbXM/Lmxlbmd0aCA/PyAwXCIgW3Jvd3NdPVwicGFnZVNpemVcIlxuICBbc2hvd0N1cnJlbnRQYWdlUmVwb3J0XT1cInRydWVcIiBjdXJyZW50UGFnZVJlcG9ydFRlbXBsYXRlPVwie2ZpcnN0fSAtIHtsYXN0fSBkaSB7dG90YWxSZWNvcmRzfVwiXG4gIFtyb3dzUGVyUGFnZU9wdGlvbnNdPVwiWzUsIDEwLCAyNSwgMTAwXVwiIChvblBhZ2UpPVwicGFnZUNoYW5nZSgkZXZlbnQpXCI+XG4gIFxuICA8IS0tIFRhYmxlIGhlYWRlciAtLT5cbiAgPG5nLXRlbXBsYXRlIHBUZW1wbGF0ZT1cImhlYWRlclwiPlxuICAgIDx0cj5cbiAgICAgIDx0aCBzdHlsZT1cIndpZHRoOjBcIiAqbmdJZj1cImJ1bGtBY3Rpb25zPy5sZW5ndGhcIj5cbiAgICAgICAgPHAtdGFibGVIZWFkZXJDaGVja2JveCAvPlxuICAgICAgPC90aD5cbiAgICAgIDx0aCAqbmdGb3I9XCJsZXQgY29sdW1uIG9mIGNvbHVtbnNcIiBbcFNvcnRhYmxlQ29sdW1uXT1cImNvbHVtbi5zb3J0ID8/ICcnXCIgcFJlb3JkZXJhYmxlQ29sdW1uPlxuICAgICAgICB7e2NvbHVtbi5uYW1lfX0gPHAtc29ydEljb24gKm5nSWY9XCJjb2x1bW4uc29ydFwiIFtmaWVsZF09XCJjb2x1bW4uc29ydFwiIC8+XG4gICAgICA8L3RoPlxuICAgICAgPHRoICpuZ0lmPVwiYWN0aW9uc1wiIGNsYXNzPVwidGV4dC1lbmRcIiBzdHlsZT1cIndpZHRoOjBcIj48L3RoPlxuICAgIDwvdHI+XG4gIDwvbmctdGVtcGxhdGU+XG5cbiAgPCEtLSBUYWJsZSBib2R5IC0tPlxuICA8bmctdGVtcGxhdGUgcFRlbXBsYXRlPVwiYm9keVwiIGxldC1pdGVtIGxldC1yb3dJbmRleD1cInJvd0luZGV4XCI+XG4gICAgPHRyIFtwU2VsZWN0YWJsZVJvd109XCJpdGVtXCIgW3BTZWxlY3RhYmxlUm93SW5kZXhdPVwicm93SW5kZXhcIj5cbiAgICAgIDx0ZCAqbmdJZj1cImJ1bGtBY3Rpb25zPy5sZW5ndGhcIj5cbiAgICAgICAgPHAtdGFibGVDaGVja2JveCBbdmFsdWVdPVwiaXRlbVwiIC8+XG4gICAgICA8L3RkPlxuICAgICAgPHRkICpuZ0Zvcj1cImxldCBjb2x1bW4gb2YgY29sdW1ucztcIj5cbiAgICAgICAgPG5nLWNvbnRhaW5lciBbbmdUZW1wbGF0ZU91dGxldF09XCJjb2x1bW4udGVtcGxhdGUgPyBnZXRUZW1wbGF0ZShjb2x1bW4udGVtcGxhdGUpIDogdGVtcGxhdGVcIlxuICAgICAgICAgIFtuZ1RlbXBsYXRlT3V0bGV0Q29udGV4dF09XCJ7ICRpbXBsaWNpdDogaXRlbSwgY29sdW1uIH1cIiAvPlxuICAgICAgPC90ZD5cbiAgICAgIDx0ZCBjbGFzcz1cInRleHQtZW5kXCIgKm5nSWY9XCJhY3Rpb25zXCI+XG4gICAgICAgIDxhcHAtYWN0aW9uIFtkYXRhXT1cIml0ZW1cIiBbYWN0aW9uc109XCJhY3Rpb25zXCIgLz5cbiAgICAgIDwvdGQ+XG4gICAgPC90cj5cbiAgPC9uZy10ZW1wbGF0ZT5cblxuICA8bmctdGVtcGxhdGUgcFRlbXBsYXRlPVwiZW1wdHltZXNzYWdlXCI+XG4gICAgPHRyPlxuICAgICAgPHRkIGNsYXNzPVwibWF0LWNlbGwgdGV4dC1jZW50ZXJcIiBbYXR0ci5jb2xzcGFuXT1cIjEwMFwiPlxuICAgICAgICB7eyAnTmVzc3VuIGVsZW1lbnRvIGRhIHZpc3VhbGl6emFyZScgfX0gPCEtLSAvLyBUT0RPOiBUcmFuc2xhdGUgLS0+XG4gICAgICA8L3RkPlxuICAgIDwvdHI+XG4gIDwvbmctdGVtcGxhdGU+XG4gIDxuZy10ZW1wbGF0ZSBwVGVtcGxhdGU9XCJwYWdpbmF0b3JsZWZ0XCI+PC9uZy10ZW1wbGF0ZT5cbjwvcC10YWJsZT5cblxuPCEtLSBUYWJsZSBkYXRhIHRlbXBsYXRlIC0tPlxuPG5nLXRlbXBsYXRlICN0ZW1wbGF0ZSBsZXQtaXRlbSBsZXQtY29sdW1uPVwiY29sdW1uXCI+XG4gIEBzd2l0Y2ggKGNvbHVtbi50eXBlKSB7XG4gICAgQGNhc2UgKERhdGFUeXBlLkRhdGUpIHtcbiAgICAgICAge3sgY29sdW1uLnZhbHVlKGl0ZW0pIHwgZGF0ZTogJ2RkL01NL3l5eXknIH19XG4gICAgfVxuICAgIEBjYXNlIChEYXRhVHlwZS5EYXRlVGltZSkge1xuICAgICAgICB7eyBjb2x1bW4udmFsdWUoaXRlbSkgfCBkYXRlOiAnZGQvTU0veXl5eSwgaGg6bW0nIH19XG4gICAgfVxuICAgIEBjYXNlIChEYXRhVHlwZS5BbW91bnQpIHtcbiAgICAgICAge3sgY29sdW1uLnZhbHVlKGl0ZW0pIHwgY3VycmVuY3k6ICdFVVInOiAnc3ltYm9sJyA6IHVuZGVmaW5lZDogJ2l0LUlUJyB9fVxuICAgIH1cbiAgICBAY2FzZSAoRGF0YVR5cGUuQm9vbCkge1xuICAgICAgICB7eyBjb2x1bW4udmFsdWUoaXRlbSkgPyAnU2knOiAnTm8nIH19XG4gICAgPCEtLSAvLyBUT0RPOiBUcmFuc2xhdGUgLS0+XG4gICAgfVxuICAgIEBjYXNlIChEYXRhVHlwZS5Db2xvcikge1xuICAgICAgICA8aSBjbGFzcz1cImJpIGJpLWNpcmNsZS1maWxsXCIgW3N0eWxlLmNvbG9yXT1cImNvbHVtbi52YWx1ZShpdGVtKVwiPjwvaT5cbiAgICB9XG4gICAgQGRlZmF1bHQge1xuICAgICAgICB7eyBjb2x1bW4udmFsdWUoaXRlbSkgfX1cbiAgICB9XG4gIH1cbjwvbmctdGVtcGxhdGU+Il19